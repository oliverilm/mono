{"version":3,"file":"JsonDescriptionUtil.mjs","sources":["../../../src/utils/internal/JsonDescriptionUtil.ts"],"sourcesContent":["import { OpenApi } from \"../../OpenApi\";\n\nexport namespace JsonDescriptionUtil {\n  export const cascade = (props: {\n    prefix: string;\n    components: OpenApi.IComponents;\n    $ref: string;\n    description: string | undefined;\n    escape: boolean;\n  }): string | undefined => {\n    const index: number = props.$ref.lastIndexOf(\".\");\n    if (index === -1) return props.description;\n\n    const accessors: string[] = props.$ref.split(props.prefix)[1].split(\".\");\n    const pReferences: IParentReference[] = accessors\n      .slice(0, props.escape ? accessors.length : accessors.length - 1)\n      .map((_, i, array) => array.slice(0, i + 1).join(\".\"))\n      .map((key) => ({\n        key,\n        description: props.components.schemas?.[key]?.description,\n      }))\n      .filter((schema): schema is IParentReference => !!schema?.description)\n      .reverse();\n    if (pReferences.length === 0) return props.description;\n    return [\n      ...(props.description?.length ? [props.description] : []),\n      ...pReferences.map(\n        (pRef, i) =>\n          `Description of the ${i === 0 && props.escape ? \"current\" : \"parent\"} {@link ${pRef.key}} type:\\n\\n` +\n          pRef.description\n            .split(\"\\n\")\n            .map((str) => `> ${str}`)\n            .join(\"\\n\"),\n      ),\n    ].join(\"\\n\\n------------------------------\\n\\n\");\n  };\n}\n\ninterface IParentReference {\n  key: string;\n  description: string;\n}\n"],"names":["JsonDescriptionUtil","cascade","props","index","$ref","lastIndexOf","description","accessors","split","prefix","pReferences","slice","escape","length","map","_","i","array","join","key","components","schemas","filter","schema","reverse","pRef","str"],"mappings":"AAEM,IAAWA;;CAAjB,SAAiBA;IACFA,oBAAAC,UAAWC;QAOtB,MAAMC,QAAgBD,MAAME,KAAKC,YAAY;QAC7C,IAAIF,WAAW,GAAG,OAAOD,MAAMI;QAE/B,MAAMC,YAAsBL,MAAME,KAAKI,MAAMN,MAAMO,QAAQ,GAAGD,MAAM;QACpE,MAAME,cAAkCH,UACrCI,MAAM,GAAGT,MAAMU,SAASL,UAAUM,SAASN,UAAUM,SAAS,GAC9DC,KAAI,CAACC,GAAGC,GAAGC,UAAUA,MAAMN,MAAM,GAAGK,IAAI,GAAGE,KAAK,OAChDJ,KAAKK,QAAS;YACbA;YACAb,aAAaJ,MAAMkB,WAAWC,UAAUF,MAAMb;aAE/CgB,QAAQC,YAAyCA,QAAQjB,cACzDkB;QACH,IAAId,YAAYG,WAAW,GAAG,OAAOX,MAAMI;QAC3C,OAAO,KACDJ,MAAMI,aAAaO,SAAS,EAACX,MAAMI,gBAAe,OACnDI,YAAYI,KACb,CAACW,MAAMT,MACL,sBAAsBA,MAAM,KAAKd,MAAMU,SAAS,YAAY,mBAAmBa,KAAKN,mBACpFM,KAAKnB,YACFE,MAAM,MACNM,KAAKY,OAAQ,KAAKA,QAClBR,KAAK,UAEZA,KAAK;AAAyC;AAEnD,EAlCD,CAAiBlB,wBAAAA,sBAkChB,CAAA;;"}